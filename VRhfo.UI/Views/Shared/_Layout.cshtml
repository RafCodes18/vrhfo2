@inject IHttpContextAccessor HttpContextAccessor
@using Microsoft.AspNetCore.Http;

<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google Tag Manager -->
    <script>
        (function (w, d, s, l, i) {
            w[l] = w[l] || []; w[l].push({
                'gtm.start':
                    new Date().getTime(), event: 'gtm.js'
            }); var f = d.getElementsByTagName(s)[0],
                j = d.createElement(s), dl = l != 'dataLayer' ? '&l=' + l : ''; j.async = true; j.src =
                    'https://www.googletagmanager.com/gtm.js?id=' + i + dl; f.parentNode.insertBefore(j, f);
        })(window, document, 'script', 'dataLayer', 'GTM-5WM46PDC');</script>
    <!-- End Google Tag Manager -->


    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <title>BrainBreaker.TV</title>
    <link rel="icon" href="/img/logop.png" type="image/icon type">

    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/VRhfo.UI.styles.css" asp-append-version="true" />
    <link href="https://fonts.googleapis.com/css2?family=Barlow:ital,wght@0,600;0,800;1,600;1,700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Raleway:ital,wght@0,100..900;1,100..900&family=Recursive:wght@300..1000&family=Roboto:ital,wght@0,400;1,300&display=swap" rel="stylesheet">
    <script src="https://kit.fontawesome.com/8b1653d39b.js" crossorigin="anonymous"></script>
    <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>


    <style>
        body{
            overflow-x: hidden;
        }

        .username-txt{
            color: deepskyblue;
            font-weight: 700;
        }
        @@media(max-width: 1000px){
        .footer-top-row{
            flex-direction: column !important;
            align-items: center;
        }
       
        #timer{
            font-size: 19px;
        }
    }
        @@media(min-width: 520px) {
            .username-txt {
                font-size: 14px !important;
            }
        }

        @@media(max-width: 405px) {
            .username-txt {
                font-size: 10px !important;
            }
        }
        }
        .username-txt:hover{
            cursor: pointer;
            color: #0098cb;
        }
        .custom-navbar {
            background-color: #010101;
            z-index: 999999 !important;

        }


        .search-form{
            max-width: 600px;
            margin-left: 20px;
        }
        .navbar-nav {
            width: 100%;
            justify-content: space-between;
            margin-bottom: 0;
            padding: 0 !important;
            height: 50px;
        }

            .navbar-nav .search {
                flex-grow: 1;
                margin-left: 20px;
                margin-right: 20px;
            }

            .navbar-nav .nav-link {
                margin-left: auto;
            }

        /* change button color to pink and search box width */
        .btn-outline-primary {
            color: var(--primary-color);
            border-color: var(--primary-color);
        }.btn-outline-primary:focus {
            border-color: var(--primary-color) !important;
        }.btn-outline-primary2:focus {
            border-color: var(--primary-color) !important;
        }
        .btn-outline-primary2{
            color: var(--primary-color) !important;
            border-color: var(--primary-color) !important;
        }

            .btn-outline-primary:hover {
                background-color: var(--primary-color);
                color: #000;
                border-color: var(--primary-color);
            }

        .form-control {
            width: 400px; /* change this as per your requirement */
        }
        /* reduce space between links */
        .navbar-nav .nav-item {
            margin-left: 10px; /* change this as per your requirement */
        }

        .nav-item .search {
            max-width: 50%;
            margin: 50% auto;
        }

        .custom-search {
            position: relative;
            width: 100%;
            background-color: black;
            border: 1px solid var(--primary-color);
            padding: 8px 20px;
        }

        .join-now {
            position: relative;
            top: 3px;
            color: #333 !important;
            font-weight: bold;
            border-radius: 4px;
            width: 110px;
            text-align: center;
            font-size: medium;
            height: 37px;
            background-color: var(--primary-color);
            /* background-color: rgb(0, 153, 205); */
        }

            .join-now:hover {
                background-color: var(--primary-color);
            }

        .login {
            border-radius: 4px;
            /* border: 1px solid grey; */            
            margin-right: 10px;
            color: #EB7FCB;
            width: 85px;
            text-align: center;
            height: 40px;
            margin-top: 3px;
            font-weight: 700;
            font-size: medium;
        }

            .login:hover {
                color: #fff;
                background-color: rgba(87, 87, 87, 0.60);
                cursor: pointer;
            }

        .center {
            text-align: center;
        }

        a {
            text-decoration: none;
        }

        .buttons {
            display: flex;
            margin-right: 10px;
            margin-top: 5px;
        }

        .search {
            margin-top: 5px;
            margin-bottom: 5px;
            padding: 0;
        }
        .custom-search{
            color: white !important;
        }
        .cust {
            border: 1px solid grey;
        }

        .no-hands {
            position: relative;
            top: 10px;
            font-family: 'Sans Serif Collection';
        }

        .container {
            margin: 0; /* Remove container margin */
            max-width: 100%; /* Ensure container takes up full width */
            margin-top: 16px;
            padding: 0;
        }

        /* Media query for iPhone 12 screen */
        .custom-search:focus{
            outline: none !important;
            box-shadow: none !important;
            border-color: white !important;
            background-color: black;
            color: white !important;
        }
        .search-cue{
            border: 1px solid white !important;
            border-color: white;
            color: white !important;
        }       
        
        .sub-link-item:hover{
            color: #fff;
           background-color: #393939;
            cursor: pointer;
        }

        .link-box{
            margin-left: 25px;
        }

        .input-group {
            min-width: 120px;
        }

               
            .goggles{
                margin-top: 10px;
            }
            .searchbar{
                width: 100%;
            }
           
            .right{
                    margin-left: 110px;
            }
            .right-lnk{
            color: hotpink !important;
            font-weight: 700;
            text-decoration:overline;
            letter-spacing: 2px;
        }
        .right-lnk:hover{
            color: #e058bb !important;
        }
   

  
        .categories-dropdown-container {
            display: flex;
            justify-content: space-evenly;
            padding: 0px 40px;
        }

        .sub-link-item {
=            white-space: nowrap; /* Prevent text wrapping */
            overflow: hidden; /* Hide text if it exceeds the container */
            text-overflow: ellipsis;
            font-size: large;
            background-color: var(--secondary-color);
            border-radius: 3px;
            padding: 10px 20px;
            font-family: 'Lucida Console';
            color: white;
            margin-left: 5px !important;
            margin: 0 !important;
            margin-right: 4px !important;
        }
        .dropdown-content.cat{
            margin-left: 10px;
            margin-top: 5px;
        }
        .vr-link{
            color: var(--primary-color);
        }.vr-link:hover{
            color: var(--primary-color);
        }
        .premium-link{
            color: #00bfff;
        }

        .premium-link:hover {
            color: #0099cd;
        }
        .top-editors{
            color: var(--accent-color);
        }
        .top-editors:hover{
                color: #c9cdfa !important;
        }
        .sub-link-item {
            position: relative;
            border-left: 2px solid #555;
            padding-left: 6px;
            height: 100%;
        }
        .site-name-logo{
            color: var(--primary-color);
            font-family: "Barlow", sans-serif;
            font-weight: 700;
            font-size: 2.4rem;
            letter-spacing: -1px;
            padding: 0px !important;
            margin: 0 !important;
            position: relative;
            margin-top: 15px !importantl;
        }             









        
        .login-modal-main {
            height: 320px;
            max-width: 400px;
            background-color: #131313;
            color: var(--text-color);
            border-radius: 10px;
            padding: 23px !important;
            position: fixed;
            z-index: 999999999999999;
            margin-left: auto;
            margin-right: auto;
            left:0;
            right: 0;
            top: 20% !important;
            outline: 1px solid var(--accent-color);
           
        }
        .login-modal-options {
            display: flex;
            justify-content: space-around;
            margin: 1px;
        }  
        .login-custom-x {
            position: absolute;
            right: 0;
            top: 0;
            margin-right: 12px;
            margin-top: 3px;
            font-size: x-large;
            color: #888;
        }
        .login-custom-x:hover {
            border-radius: 8px !important;
            cursor: pointer;
            color: #fff;
            transition: 300ms;
        }
        .hidden{
            display: none !important;
        }        
        .overlay {
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #000;
            opacity: 0.8;
            z-index: 99999999;
        }
        .white{
            color: #fff;
        }
       .rotate-right{
            display: inline-block; /* Ensures the span takes up only as much space as the letter */
            transform: rotate(30deg); /* Rotate the element by 45 degrees */
            margin-left: 3px;
            margin-right: -2px;
       }
       .rotate-left{
            display: inline-block; /* Ensures the span takes up only as much space as the letter */
            transform: rotate(333deg); /* was 340deg before 10/21 */
            margin-right: -1px;
       }




        #sidebar {
            position: absolute;
            left: 0;
            height: 100vh;
            max-width: 280px;
            width: 100%;
            background-color: transparent;
            transition: transform 0.3s ease-in-out;
            z-index: 99999  !important;
            margin-top:10px !important;
            margin-right: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding-left: 13px;
            min-width: 200px;
            overflow-y: scroll;    
         }
        #sidebar.open {
            transform: translateX(0);
        }

        #toggleSidebar {
            margin-left: 5px;
            background-color: transparent;
            border: none;
            color: white;
            font-size: 30px;
           
        }

        #toggleSidebarM {
             background-color: transparent;
            border: none;
            color: white;
            font-size: 30px;
        }
        #toggleSidebar:hover{
            color: #bbb;
            border-radius: 50%;

        }
        @@media (min-width: 1000px) {
              #sidebar {
                position: static;
                transform: none;
              }  
  
              #sidebar.closed {
                display: none;
              }
  
              main.sidebar-closed {
                margin-left: 0;
              }    
              
        }    
        @@media(max-width: 1000px){
            #sidebar{
                position: fixed;
                display: none;
            }
            .card-container{
                margin: 0 !important;
                padding: 0 !important;
             }
            .navbar{
                position: fixed;
                z-index: 999;
                width: 100vw;
                /* Force hardware acceleration */
                transform: translateZ(0);
                will-change: transform;
                /* Optional: Improve performance on mobile */
                -webkit-overflow-scrolling: touch;
            }
            .video-index-container{
                margin-top: 80px;
            }
            .vid{
                margin-top: 60px;
            }
            .home-link{
                margin-top: 10px !important;
            }            
        }

    .categories-ul-container{
        list-style-type: none !important;        
    }   
        
    .sb-link{
            color: #bbb;
            position: relative;
            width: 90%;
            max-width: 100%;
            padding: 5px 9px;
            margin-bottom: 3px;
            font-size: 18px;
            border-radius: 6px;
            margin-left: 2px;
            margin-top: 3px;
            z-index: 9 !important;
    }
        .sb-link:hover {
            background-color: #393939;
            cursor: pointer;
            color: white;
        }
        .sidebar-title{
            color: var(--accent-color);
            font-size: 22px ;            
            margin-right: auto;   
            font-weight: 600;
        }
        .breaker{
            width: 90%;
            border-bottom: 1px solid #444;
            margin: 10px 0;
        }

        main {
            display: flex;
            flex-direction: row;
            margin-top: 0px;
        }
        .main-pg{
            width: 100vw;
            overflow-y: auto;
        }
        .home-svg{
            margin-right: 5px;
            margin-bottom: 5px;
            height: 18px !important;
            width: 18px !important;
        }
        .sidebar-icons{
            margin-right: 5px;
            margin-bottom: 5px;
            height: 22px !important;
            width: 22px !important;
        }   
        
        .mobile-sidebar{
            display: flex !important;
            background-color: #111 !important;
            top: 54px !important;
            height: 90vh !important;
            border-right: 1px solid #222;
        }
        .explain{
            font-size: x-small;
        }
        .live-indicator {
              display: inline-flex;
              align-items: center;
              font-weight: 600;
                color: var(--primary-color);
              font-size: 15px;
              margin-right: 10px; 
            }

.live-indicator::before {
  content: '';
  display: inline-block;
  width: 7px;
  height: 7px;
                background-color: var(--primary-color);
  border-radius: 50%;
                margin-right: 5px;
                margin-left: 7px;
                animation: pulse 1.5s ease-in-out infinite;
}

@@keyframes pulse {
  0% {
    transform: scale(0.95);
                box-shadow: 0 0 0 0 var(--primary-color);
  }
  70% {
    transform: scale(1);
    box-shadow: 0 0 0 10px rgba(255, 0, 0, 0);
  }
  100% {
    transform: scale(0.95);
    box-shadow: 0 0 0 0 rgba(255, 0, 0, 0);
  }
}

    .links-container{
        display: flex;
        justify-content: center;
        align-items:center;
        position: sticky;
    }
    .link-item{
        padding-right: 20px;
        color: #999;
    } .link-item:hover{
        color: #ddd;
        text-decoration: underline;
        cursor: pointer;
    }
    .network-txt{
        margin-left: 20px;
        margin-right: 20px;
        color: #ccc;
    }

        .sticky {
            position: fixed;
            top: 0px;
            width: 100%;
        }
        .network-txt{
            color: #aaa;
        }
        @@media(max-width: 1000px){
            .black-nav{
                display: none !important;
            }
        }
        .home-link{
            font-size: 20px !important;
            font-weight: 700 !important;
            margin-bottom: -6px;
        }
        .black-nav{
            background: #222;
            margin-bottom: 0px;
            border-bottom: 1px dotted #333;
        }

        .mobile-footer{
            width: 100%;
            height: 79px !important;
            position: fixed;
            bottom: 0px;
            display: flex;
            justify-content: space-around;
            background: #121212;
            z-index: 9999;
            align-items: center;
            /* Force hardware acceleration */
            transform: translateZ(0);
            will-change: transform;    
            /* Optional: Improve performance on mobile */
            -webkit-overflow-scrolling: touch;
        }

        .footer-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-decoration: none;
            color: #333;
            padding-bottom: 29px;
            padding-top: 10px;
        }

        .footer-icon img{
=            height: 20px;
            width: 20px;
        }
        @@media(min-width: 1000px)
        {
            .mobile-footer{
                display: none !important;
            }
           
        }
        .footer-text{
            color: #aaa !important;
            font-size: 14px;
        }
        .nav-left{
            display: flex;
        }
        #login-button2:hover{
            cursor: pointer;
        }
        .your-stats-container{
            display: flex;
            flex-direction: column;
            align-items: start;
            align-self: start;
            width: 97% !important;
            font-family: 'Trebuchet MS';
            background-color: #0a0a0a;
            border-radius: 10px; 
            border: 1px solid grey;
            padding: 5px;
            margin-bottom: 15px;
        }

        .your-stats-container h5{
            padding: 1px;
            font-size: medium;
            left: 0 !important;
            color: #666;
            align-self: center;
        }
        @@keyframes color-change {
          0% { color: #888; }
          50% { color: #eee; }
          100% { color: var(--primary-color); }
        }
        .your-stats a{
            align-self: start;
            margin-left: 0 !important;
            padding-left: 0 !important;
            color: var(--accent-color) !important;
        }

        .result-box ul{
            border-top: 1px solid #999;
            padding: 15px 10px;
            background-color: #000 !important;
        }
        .result-box-2{
            padding: 2px;
            background-color: #252525;

        }.result-box-2 ul{
            padding: 0px !important;
                background-color: #333;
        }
            .result-box ul li {
            list-style: none;
            border-radius: 3px;
            padding: 5px 10px;
            cursor: pointer;
        }
         .result-box-2 ul li{
            list-style: none;
            border-radius: 5px;
            padding: 10px 10px;
            cursor: pointer;
        }
        .result-box-2 li{
            background-color: #111 !important;
            margin: 3px;
            padding: 3px;
            color: var(--primary-color);
        }
        .result-box li:hover, .result-box-2 li:hover {
                background-color: #555;
            }

        .result-box, .result-box-2 {
            max-height: 200px;
            overflow-y: scroll;
        }
        #Search::-webkit-search-cancel-button {
            filter: invert(97%) sepia(11%) saturate(2878%) hue-rotate(346deg) brightness(104%) contrast(97%);
            cursor: pointer;
            padding: 2px;
        }
        .mobile-search{ 
            position: fixed;
            top: 13%;
            width: 98%;
            z-index: 999999999 !important;
        }
        .mobile-search input{
                position: relative;
                width: 100%;
                background-color: black;
                border: 1px solid var(--primary-color);
                padding: 8px 20px;
                font-size: large;
                z-index: 999999999 !important;
            }
        .mobile-search input:focus{
                    outline: none !important;
                    box-shadow: none !important;
                    border-color: white !important;
                    background-color: black;
                    color: white !important;
        }        
        .overlay2{
            position: fixed;
            top: 0;
            bottom: 0;
            left: 0;
            right: 0;
            background-color: #000;
            opacity: 0.9;
            z-index: 99999;      
        }
       /*  .nav-top{
            margin-right: 50px !important;
        } */

        @@media (max-width: 400px) {
            .forgot-txt{
                font-size: 13px !important;
            }
            .not-mem-txt{
                font-size: x-small !important;
            }
            .login-modal-title{
                font-size: 24px !important;
            }
        }
        .settings-gear{
            margin: 6px;
        }

        .view-all-link{
            color: var(--accent-color);
            font-size: 14px;
            padding: 5px 9px;
            border-radius: 7px;
            text-decoration: underline;            
        }
        .view-all-link:hover{
            color: #979797;
        }
        .top-DD-link:hover{
            border-radius: 10px 10px 0px 0px !important;
        }
        .bottom-DD-link:hover{
            border-radius: 0px 0px 10px 10px !important;
            transition-duration: 0s !important;
        }
        .bottom-DD-link{
            border-bottom: none !important;
            transition-duration: 0s !important;
        }




















         /* User Menu Container */
        .user-menu {
            position: relative;
            display: inline-block;
        }

        /* Username Button */
        .username-btn {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.8rem 1.2rem;
            background: rgba(127, 255, 0, 0.1);
            border: 1px solid rgba(127, 255, 0, 0.2);
            border-radius: 25px;
            color: var(--primary-color);
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .username-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(127, 255, 0, 0.2), transparent);
            transition: left 0.5s ease;
        }

        .username-btn:hover::before {
            left: 100%;
        }

        .username-btn:hover {
            background: rgba(127, 255, 0, 0.2);
            border-color: var(--primary-color);
            box-shadow: var(--btn-hover-shadow);
            transform: translateY(-2px);
        }

        .username-btn::after {
            content: '▼';
            font-size: 0.7rem;
            transition: transform 0.3s ease;
        }

        .user-menu:hover .username-btn::after {
            transform: rotate(180deg);
        }

        /* Dropdown Menu */
        .dropdown-menuz {
            position: absolute !important;
            top: calc(100% + 15px);
            right: 0;
            min-width: 220px;
            background: rgba(38, 39, 39, 0.95);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(127, 255, 0, 0.2);
            border-radius: 16px;
            overflow: hidden;
            display: hidden !important;
            opacity: 0;
            visibility: hidden;
            transform: translateY(-20px) scale(0.95);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.4),
                0 0 30px rgba(127, 255, 0, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            z-index: 1001;
        }

        /* Dropdown glow effect */
        .dropdown-menuz::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, 
                rgba(127, 255, 0, 0.3) 0%, 
                rgba(127, 255, 0, 0.1) 25%, 
                transparent 50%, 
                rgba(127, 255, 0, 0.1) 75%, 
                rgba(127, 255, 0, 0.3) 100%);
            border-radius: 18px;
            opacity: 0;
            transition: opacity 0.3s ease;
            z-index: -1;
        }

        .user-menu:hover .dropdown-menuz::before {
            opacity: 1;
        }

        /* Show dropdown on hover */
        .user-menu:hover .dropdown-menuz {
            opacity: 1;
            visibility: visible;
            transform: translateY(0) scale(1);
        }

        /* Dropdown items */
        .dropdown-item {
            display: flex;
            align-items: center;
            gap: 0.8rem;
            padding: 1rem 1.2rem;
            color: var(--accent-color);
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .dropdown-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, 
                transparent, 
                rgba(127, 255, 0, 0.1), 
                transparent);
            transition: left 0.5s ease;
        }

        .dropdown-item:hover::before {
            left: 100%;
        }

        .dropdown-item:hover {
            background: rgba(127, 255, 0, 0.08);
            color: var(--primary-color);
            transform: translateX(5px);
            box-shadow: inset 3px 0 0 var(--primary-color);
        }

        /* Icons */
        .dropdown-item .icon {
            font-size: 1.1rem;
            transition: all 0.3s ease;
            filter: drop-shadow(0 0 5px rgba(127, 255, 0, 0.3));
        }

        .dropdown-item:hover .icon {
            transform: scale(1.2);
            filter: drop-shadow(0 0 10px rgba(127, 255, 0, 0.6));
        }

        /* Special styling for logout */
        .dropdown-item.logout {
            border-top: 1px solid rgba(127, 255, 0, 0.1);
            color: #ff6b6b;
            margin-top: 0.5rem;
        }

        .dropdown-item.logout:hover {
            background: rgba(255, 107, 107, 0.1);
            color: #ff8a8a;
            box-shadow: inset 3px 0 0 #ff6b6b;
        }

        /* Responsive Design */
        @@media (max-width: 768px) {
 
            .dropdown-menuz {
                right: -10px;
                min-width: 200px;
            }
            
            .username-btn {
                padding: 0.6rem 1rem;
                font-size: 0.9rem;
                margin-top: 7px;
            }
        }
         @@media (max-width: 468px) {
 
            .dropdown-menuz {
                right: -10px;
                min-width: 200px;
            }
            
            .username-btn {
                padding: 0.6rem 1rem;
                font-size: 0.7rem;
            }
        }

        .curr-streak{
            color: var(--accent-color) !important;
        }
    </style>
</head>
<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript>
        <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5WM46PDC"
                height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <!-- End Google Tag Manager (noscript) -->
    <header>
  
    <div class="black-nav">
         <div class="links-container">
            <div class="network-txt">Network:</div>
            <div class="link-item">Announcements</div>
            <div class="link-item">BrainBreaker.tv Discord</div>
            <div class="link-item">Support the site</div>
            <div class="link-item">Gooner Store</div>
         </div>
    </div>
        <nav class="navbar custom-navbar navbar-expand navbar-toggleable-sm box-shadow " id="navbarr">
          
            <div class="container-fluid">
                <div class="navbar-collapse collapse d-sm-inline-flex justify-content-between">
                    <ul class="navbar-nav flex-lg-row nav-top">
                       
                            <div class="nav-left">
                                <button class="hamburger ham-top" id="toggleSidebar">☰</button>

                                    <a class="navbar-brand brain-break" asp-area="" asp-controller="Video" asp-action="Index" asp-route-category="Latest">
                                         <p class="site-name-logo"><span class="white">Brain</span>B<span class="rotate-left">r</span><span class="rotate-right">e</span>aker<span class="white">.tv</span></p>
                                    </a>
                            </div>
                            
                            <li class="nav-item search">
                                <form class="form-inline   search-form">
                                    <div class="input-group searchbar">
                                        <input id="Search" type="search" class="form-control  custom-search" placeholder="Search"   data-search/>
                                        <button type="button" class="btn btn-outline-primary"><i class="fa-solid fa-magnifying-glass"></i></button>                                                                          
                                    </div>
                                <div class="result-box">
                                     
                                </div>
                                </form>
                            </li>
                        @{
                            var username = HttpContextAccessor.HttpContext?.Session.GetString("username");
                        }
                        @if (Authenticate.IsAuthenticated(Context) && username != "")
                        {
                           

                            <div class="buttons">
                               
                                    <!--WELCOME USER-->
                                <ul class="navbar-nav">

                                    <li class="nav-item">
                                       <!-- User Menu -->
                                          <div class="user-menu">
                                                <div class="username-btn">
                                                    <span>@@@username</span>
                                                </div>
            
                                                <!-- Dropdown Menu -->
                                                <div class="dropdown-menuz">
                                                    <a asp-action="Index" asp-controller="User" asp-route-username="@username" class="dropdown-item">
                                                        <span class="icon">👤</span>
                                                        <span>Profile</span>
                                                    </a>
                
                                                    <a asp-action="Liked" asp-controller="Home" class="dropdown-item">
                                                        <span class="icon"><img src="@Url.Content("~/img/like.svg")" class="m-1" height="20" width="20" /></span>
                                                        <span>Favorites</span>
                                                    </a>
                
                                                    <a asp-action="ManageAccount" asp-controller="User" asp-route-username="@username" class="dropdown-item">
                                                        <span class="icon">⚙️</span>
                                                        <span>Settings</span>
                                                    </a>

                                                    <a asp-action="logout" asp-controller="User" class="dropdown-item logout">
                                                        <span class="icon">🚪</span>
                                                        <span>Logout</span>
                                                    </a>
                                                </div>
                                          </div>
                                    </li>
 
                                </ul>
                            </div>
                        }
                        else
                        {
                            <div class="nav-login-buttons">
                                <li class="nav-item">
                                    <a id="login-button" class="nav-link text-light login">Login</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link text-light join-now" asp-controller="Home" asp-action="JoinNow">Join Now</a>
                                </li>
                             </div>
                        }
                    </ul>
            </div>    
            </div>
        </nav>                
    </header>               
        <main role="main" class="pb-3 page " >
            <nav id="sidebar" class="">
                <a class="sb-link home-link" asp-action="Index" asp-controller="Video" asp-route-category=""><svg class=" home-svg" width="19" height="18" viewBox="0 0 19 18" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M17.7 17.957h-5.829a.764.764 0 0 1-.762-.762v-3.62c0-.914-.724-1.638-1.638-1.638-.915 0-1.639.724-1.639 1.638v3.62c0 .42-.343.762-.762.762H1.317a.764.764 0 0 1-.762-.762V7.441c0-.686.343-1.334.876-1.715L9.09.201c.266-.19.61-.19.876 0l7.658 5.525c.534.381.877 1.029.877 1.715v9.792a.822.822 0 0 1-.8.724Zm-5.067-1.486h4.344v-9.03a.651.651 0 0 0-.267-.495l-7.201-5.22-7.202 5.181a.651.651 0 0 0-.266.496v9.03h4.343v-2.858a3.139 3.139 0 0 1 3.125-3.124 3.139 3.139 0 0 1 3.124 3.124v2.896Z" fill="#fff"></path></svg> Home</a>
                <div class="breaker"></div>

                <p class="sidebar-title">Categories</p>                
                    <a class="sb-link sb-link-top" asp-action="Index" asp-controller="Video" asp-route-category="Latest"><img class="sidebar-icons" src="~/img/new (1).png" />  Latest uploads</a>
                    <a class="sb-link" asp-action="Index" asp-controller="Video" asp-route-category="Gooning"><img class="sidebar-icons" src="~/img/hypnosis.png" />  Gooning</a>

                    <a class="sb-link" asp-action="Index" asp-controller="Video" asp-route-category="Brainwashing"><img class="sidebar-icons" src="~/img/cogwheel.png" />  Brainwashing</a>
                    <a class="sb-link" asp-action="Index" asp-controller="Video" asp-route-category="HFO"><img class="sidebar-icons" src="~/img/prohibition.png" /> HFO <span class="explain">(Hands Free Orgasm)</span></a>
                    <a class="sb-link" asp-action="Index" asp-controller="Video" asp-route-category="Hypnosis"><img class="sidebar-icons" src="~/img/hypnosis (2).png" />  Hypnosis</a>  
                    <a class="view-all-link" asp-action="Categories" asp-controller="Video">View All</a>  
                    <div class="breaker"></div>
                    
                 <a class="sb-link sb-link-flex" asp-action="Live" asp-controller="Home">
                    <span class="sb-left">
                        <img class="sidebar-icons" src="~/img/tv.png" /> GoonTV™
                    </span>
                    <span class="live-indicator">  Live</span>
                </a>
                    
                    <div class="breaker"></div>
                    <a class="sb-link" asp-action="Captions" asp-controller="Home">Porn Captions</a>
                    <a class="sb-link" asp-action="Index" asp-controller="Video" asp-route-category="Top">Top Gooners</a>

                    <div class="your-stats-container">
                @if (Authenticate.IsAuthenticated(Context) && username != "")
                {
                    <p class="sb-link your-stats"><a asp-action="Index" asp-controller="User" asp-route-username="@username">Hours Gooning</a> </p>

                }
                else
                {
                    <p class="sb-link your-stats"><a asp-action="JoinNow" asp-controller="Home">Hours Gooning</a> </p>

                }

                       <div class="stats-2-boxes">
                             <div class="stat-box">
                                <h5><span class="lesser">Today </span><span class="watch-time-value">32m 12s</span></h5>
                        <h5><span class="lesser">This week </span> <span class="watch-time-value">5h 12m</span></h5>

                             </div>
                             
                             <div class="stat-box">
                                                                <h5><span class="lesser">This month </span> <span class="watch-time-value">23h</span></h5>

                             <h5><span class="lesser">This year</span> <span class="watch-time-value">114h</span></h5>
                             </div>                                                                             
                       </div>
                        
                        
                        <h5>Lifetime: <span class="watch-time-lifetime">234 hours</span></h5>
                    </div>
                      @if (Authenticate.IsAuthenticated(Context) && username != "")
                {
                    <p class="curr-streak">🔥 Current Streak: 1 day </p>
                                <div class="account-settings-link">
                                    <a asp-action="ManageAccount" asp-controller="User" asp-route-username="@username">Account Settings</a>
                                </div>     
                }
            </nav>
            <div class="overlay hidden">
                  
            </div>
            <div class="overlay2 hidden">
                  
            </div>
                            
<!-- 🔥 STREAK MODAL -->
<div class="streak-modal" id="streakModal" style="display: none;">
  <div class="streak-box">
    <div class="streak-emoji">🔥</div>
    <div class="streak-title" id="streakTitle">Streak: 1 Day</div>
    <div class="streak-desc" id="streakDesc">Keep it up! Come back tomorrow to build your streak. Rewards may be coming… 👀</div>
    <button class="close-btn-streak" onclick="closeStreakModal()">Got it</button>
  </div>
</div>  
            <div id="login-modal" class="login-modal-main hidden">
                <div class="login-modal-contain">
                    <span id="close-login-modal" class="login-custom-x">&times;</span>
                    <h3 class="login-modal-title">Member Login</h3>
                    <p class="not-mem-txt">Not a member? Click to<a asp-controller="Home" asp-action="JoinNow" class="join-now-btn-small">Join Now</a></p>
                    <form id="login-form">
                        <div class="top-rw">
                            <input  id="email" name="email" class="txt-box email ro" placeholder="Your Email" required>
                        </div>
                        <div class="">
                            <input type="password" id="password" name="password" class="txt-box pass ro" placeholder="Password" required  >
                        </div>
                        
                        <div id="login-message"></div>

                        <button type="submit" class="login-btn ro ">Login</button>
                        <p class="forgot-txt">Forgot password? Click <a asp-action="ForgotPassword" asp-controller="User" class="here-txt">Here</a> to recover.</p>
                    </form>
                    
                </div>
            </div>


            <!--STICKY TIME STAMP DURATION OF SESSION-->
            <!--FORMATS: 00:45, 05:14, 01:13:06, etc-->
            <p class="session-duration-sticky" id="timer"></p>





            <div class="mobile-footer">                
                <a asp-action="Index" asp-controller="Video" asp-route-category="Latest" class="footer-item">
                <span class="footer-icon"><img src="@Url.Content("~/img/home.png")" /></span>
                    <span class="footer-text">Home</span>
                </a>
                <a asp-aciton="Index" asp-controller="Video" asp-action="Categories" class="footer-item">
                    <span class="footer-icon"><img src="@Url.Content("~/img/category.png")" /></span>
                    <span class="footer-text">Categories</span>
                </a>

                <!--AUTH CHECK MOBILE LOGIN-->
            @if (!Authenticate.IsAuthenticated(Context) && username != "")
            {
                <a id="login-button2"10 class="footer-item">
                    <span class="footer-icon"><img src="@Url.Content("~/img/user.png")" /></span>
                    <span class="footer-text">Login</span>
                </a>
            }
            <a  class="footer-item search-link">
                    <span class="footer-icon"><img src="@Url.Content("~/img/search.png")" /></span>
                    <span class="footer-text">Search</span>
                </a>
              @*   <a asp-action="JoinNow" asp-controller="Home" class="footer-item">
                     
                        <span class="footer-icon">
                            <svg class="o-icon o-icon-svg " viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                                <path d="M8.06419 14.7411c-.10982-.0012-.21803-.0265-.31697-.0742-.09894-.0477-.18618-.1166-.25554-.2017L.672817 6.15741c-.10166-.1231-.161673-.27526-.171411-.43461-.009738-.15935.0313-.31768.117215-.45224L3.00522 1.5931c.06641-.10241.15756-.18643.26503-.2443.10747-.05787.2278-.08772.34985-.08679l8.695.06208c.1236.00146.2448.03333.3531.0928.1083.05946.2002.14469.2677.24815l2.4389 3.70997c.0882.13302.1318.29072.1244.4502-.0075.15947-.0655.31243-.1658.43665L8.63276 14.475c-.06879.0842-.15557.1519-.25396.1981-.0984.0462-.2059.0698-.31461.069v-.001z" fill="#37C4B3"></path>
                                <path d="M10.9376 5.80361L8.06418 14.743 5.08044 5.76223l-4.578103-.0335c-.012524-.16198.028313-.3236.116275-.46018L3.00522 1.59306c.06943-.10727.16597-.19429.27984-.25225l2.91083 4.4293 3.60848.02562 2.84773-4.38792c.1124.05814.2109.14485.2838.25423L15.3748 5.373c.09.13702.1332.2995.1231.46313l-4.5603-.0335v.00098z" fill="#53E7D3"></path>
                                <path d="M7.96372 1.29253h.00788l2.966 4.51109-5.87486-.04237 2.90098-4.46872z" fill="#B9F5ED"></path>
                                <path opacity=".1" d="M2.64359 6.17018s4.98999 8.46842 4.84809 8.29592L.672817 6.15639c-.10166-.1231-.161673-.27526-.171411-.43461-.009738-.15935.0313-.31768.117215-.45224L3.00522 1.59307c.06618-.10278.15723-.18719.26472-.24541.10748-.05823.22793-.08837.35016-.08765l1.97077.01379c-.12214-.00082-.24253.02917-.35.08722-.10748.05804-.19858.14226-.26488.24486l-2.3866 3.67647c-.08614.13466-.12731.29319-.11757.45275.00974.15955.06988.3119.17177.43508z" fill="#000"></path>
                            </svg>
                        </span>                    
                    <span class="footer-text">Premium</span>
                </a> *@
            <div  class="footer-item ">
                    <button class="hamburger" id="toggleSidebarM">☰</button>
                    <span class="footer-text">Menu</span>
            </div>

            </div>
       
        <div class="mobile-search hidden">
            <form class="form-inline   search-form">
                <div class="input-group searchbar ">
                    <input id="mobileSearch" type="search" class="form-control mobile-search-bar" placeholder="Search" data-search2 />
                    <button type="button" class="btn btn-outline-primary2  "><i class="fa-solid fa-magnifying-glass"></i></button>
                </div>
                <div class="result-box-2">

                </div>
            </form>
            <div class="close-btn" onclick="toggleHidden()">
                Close
            </div>
        </div>
            @RenderBody()
        </main>
    
    <footer class="footer-box  text-muted">
        <div class="center-footer">
            <div class="footer-top-row">
                <a asp-action="Index" asp-controller="Video">Home</a>
                <a asp-action="Privacy" asp-controller="Home">Privacy Policy</a>
                <a asp-action="TermsAndConditions" asp-controller="Home">Terms of Service</a>
                <a asp-action="DMCA" asp-controller="Home">DMCA</a>
                <a asp-action="RecordsCompliance" asp-controller="Home">18 U.S.C 2257</a>

            </div>
            <div class="footer-bottom-row" >
                <a href="https://x.com/brainbreakertv" class="footer-icons" target="_blank">
                    <span  >
                        <svg id="x-twitter" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M9.52217 6.77491L15.4785 0H14.0671L8.89516 5.88256L4.76437 0H0L6.24656 8.89547L0 16H1.41155L6.87321 9.78782L11.2356 16H16L9.52183 6.77491H9.52217ZM7.58887 8.97384L6.95596 8.08805L1.92015 1.03974H4.0882L8.15216 6.72795L8.78507 7.61374L14.0677 15.0075H11.8997L7.58887 8.97418V8.97384Z" fill="white"></path>
                        </svg>
                    </span>
                </a>
                <a href="https://discord.com" class="footer-icons" target="_blank">
                    <svg class="svg-inline--fa fa-discord ma-3" aria-hidden="true" focusable="false" data-prefix="fab" data-icon="discord" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512" style="vertical-align: middle; width: 1.5rem; color: rgb(114, 137, 217);"><path class="" fill="currentColor" d="M524.531,69.836a1.5,1.5,0,0,0-.764-.7A485.065,485.065,0,0,0,404.081,32.03a1.816,1.816,0,0,0-1.923.91,337.461,337.461,0,0,0-14.9,30.6,447.848,447.848,0,0,0-134.426,0,309.541,309.541,0,0,0-15.135-30.6,1.89,1.89,0,0,0-1.924-.91A483.689,483.689,0,0,0,116.085,69.137a1.712,1.712,0,0,0-.788.676C39.068,183.651,18.186,294.69,28.43,404.354a2.016,2.016,0,0,0,.765,1.375A487.666,487.666,0,0,0,176.02,479.918a1.9,1.9,0,0,0,2.063-.676A348.2,348.2,0,0,0,208.12,430.4a1.86,1.86,0,0,0-1.019-2.588,321.173,321.173,0,0,1-45.868-21.853,1.885,1.885,0,0,1-.185-3.126c3.082-2.309,6.166-4.711,9.109-7.137a1.819,1.819,0,0,1,1.9-.256c96.229,43.917,200.41,43.917,295.5,0a1.812,1.812,0,0,1,1.924.233c2.944,2.426,6.027,4.851,9.132,7.16a1.884,1.884,0,0,1-.162,3.126,301.407,301.407,0,0,1-45.89,21.83,1.875,1.875,0,0,0-1,2.611,391.055,391.055,0,0,0,30.014,48.815,1.864,1.864,0,0,0,2.063.7A486.048,486.048,0,0,0,610.7,405.729a1.882,1.882,0,0,0,.765-1.352C623.729,277.594,590.933,167.465,524.531,69.836ZM222.491,337.58c-28.972,0-52.844-26.587-52.844-59.239S193.056,219.1,222.491,219.1c29.665,0,53.306,26.82,52.843,59.239C275.334,310.993,251.924,337.58,222.491,337.58Zm195.38,0c-28.971,0-52.843-26.587-52.843-59.239S388.437,219.1,417.871,219.1c29.667,0,53.307,26.82,52.844,59.239C470.715,310.993,447.538,337.58,417.871,337.58Z"></path></svg>
                </a>

                <a href="https://theporndude.com" class=" " target="_blank"><img src="~/img/porndudelogo.webp" height="20" width="20" /></a>
            </div>

            <p class="footer-bottom-row"> &copy; 2025 - <span class="bold">brainbreaker.tv </span></p>
        </div>
    </footer>
  
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    @await RenderSectionAsync("Scripts", required: false)
</body>

</html>
 
<style>  
   .sb-link-flex {
    display: flex;
    justify-content: space-between;
    align-items: center;
    width: 90%;
    padding-right: 8px;
}

.sb-link-flex .sb-left {
    display: flex;
    align-items: center;
    gap: 6px;
}

 @@media(max-width: 420px){
     .account-settings-link a{
        padding-bottom: 90px !important;
     }
 }
    .account-settings-link a{
        text-decoration: underline !important;
     }
    .log-out{
        margin-right: 5px !important;
    }
    .bold{
        font-weight: 800;
    }
    .footer-icons{
        margin-right: 10px;
    }
    .footer-bottom-row{
        margin-bottom: 8px !important;
    }
    .footer-box{
        display: flex;
        justify-content: center;        
        padding-bottom: 40px !important;
    }
 
    
    
    .center-footer{
        display: flex;
        flex-direction: column;
        justify-content: center;
        max-width: 500px;
        min-width: 100px;
        width: 100%;
        align-items:center;
    }
    .footer-top-row{
        margin: 0 !important;
        padding: 0 !important;
        display: flex; 
        width: 100%;
        flex-direction: row;
        justify-content: space-around !important;
        margin-bottom: 20px !important;
    }
    .footer-top-row a{
        color: #555;
    }

        .footer-top-row a:hover {
            color: #656565;
        }
    .footer{
          padding-bottom: 80px !important;
          padding-top: 20px !important;
    }
    .footer p {
        margin: 0 !important;
        padding: 0 !important;
    }
    .hamburger{
        padding: 0 !important;
    }
    #sidebar.open {
        display: block;
        transform: translateX(0);
        z-index: 99999999999999999999999999999999999999999999999999999999;
    }
    .session-duration-sticky{
        position: fixed;
        bottom: 80px;  
        right: 10px; 
        color: darkred;
        font-size: 30px;
        z-index: 9999999999999999999999 !important;
    }
    .lesser{
        font-size: smaller;
    }
    .nav-login-buttons{
        display: flex;
    }
    .sb-link-top{
        margin-top: -2px;
    }
    .watch-time-lifetime{
        font-weight: 600;
        animation: color-change-red 5s infinite;
    }

    @@keyframes color-change-red {
        0% {
            color: red;
        }
        50% {
            color: darkred;
        }
        100% {
            color: red;
        }
    }
    .watch-time-value{
        color: var(--accent-color);
        animation: color-change 5s infinite;
    }
    .stats-2-boxes{
        display: flex;
        flex-direction: column;
        width: 100%;
    }
    .stat-box{
        width: 100%;
        font-size: small;
        display: flex;
        flex-direction: row;
        justify-content: space-around;
    }  
    .stat-box h5{
        font-size: 15px;
        display: flex;
        flex-direction: column;
    }
    .close-btn{
        padding: 5px;
        background-color: #222;
        border: 1px solid var(--accent-color);
        position: absolute;
        right: 15px;
        width: 60px;
        margin-top: 9px;
        text-align: center;
        border-radius: 10px;
        cursor: pointer;
    }. 
    <!-- DIAMOND AND LIKE BUTTONS -->
    .o-icon-svg {
        pointer-events: none;
        display: block;
        width: 100%;
        height: 100%;
    }

    .o-icon {
        display: -webkit-inline-box;
        display: -ms-inline-flexbox;
        display: inline-flex;
        -webkit-box-align: center;
        -ms-flex-align: center;
        align-items: center;
        -webkit-box-pack: center;
        -ms-flex-pack: center;
        justify-content: center;
        position: relative;
        vertical-align: middle;
        fill: grey;
        width: 24px;
        height: 24px;
    }
    #login-message{
        color: darkred !important;
        font-size: large;
    }
    .not-mem-txt{
        color: white !important;
    }
    .login-modal-title{
        color: white !important;
    }
    .forgot-txt{
        color: #888;
    }
    .here-txt{

        color: white !important;
        text-decoration: underline;
    }
    .top-rw{
        margin-top: 12px;
    }
    .ro{
        margin-bottom: 10px !important;
    }
    .login-btn{
         width: 100%; 
         padding: 6px;
         background-color: var(--accent-color); 
         border-radius: 6px;
         color: #333 !important;
         font-weight: 700 !important;
         font-size: large;

    }
    .login-btn:hover{
        background-color: var(--primary-color);
        transition: 300ms;
    }
.join-now-btn-small{
        color: white !important;
        padding: 4px;
        font-weight: 700;
        background-color: transparent;
        border-radius: 4px;
        cursor: pointer;
        margin-left: 4px;
        text-decoration: underline;
    }

    .join-now-btn-small:hover {
       background-color: var(--join-now-hover); 
       color: #222 !important;
       text-decoration: none;
    }
    .txt-box{
        position: relative;
        background-color: black;
        width: 100%;
        padding: 10px;
        border-radius: 5px;
        margin: 3px;
        color: white;
        border: none ;
        outline: 2px solid hsl(206, 16%, 65%);
    }

    input:user-valid {
        outline-color: var(--primary-color) !important;
    }

    input:user-invalid {
        outline-color: darkred !important;
    }
    input:focus{
        outline-color: darkgrey;
    }
    .search-link:hover{
        cursor: pointer;
    }
    @@media (max-width: 1000px) { /* Adjust max-width as per your mobile breakpoint */
 @*  .ham-top {
    display: none; /* Hide the hamburger button on screens narrower than 768px */
  } *@
}
</style>
<script>
       
    const timerElement = document.getElementById('timer');

    let visibleElapsed = parseInt(localStorage.getItem('visibleElapsed') || 0);
    let visibleStartTime = null;
    let interval = null;

    function startTimer() {
        visibleStartTime = Date.now();
        interval = setInterval(updateTimer, 1000);
    }

    function stopTimer() {
        clearInterval(interval);
        if (visibleStartTime) {
            visibleElapsed += Math.floor((Date.now() - visibleStartTime) / 1000);
            localStorage.setItem('visibleElapsed', visibleElapsed);
            visibleStartTime = null;
        }
    }

    function updateTimer() {
        const current = visibleStartTime ? Math.floor((Date.now() - visibleStartTime) / 1000) : 0;
        timerElement.textContent = `${visibleElapsed + current}s`;
    }

    document.addEventListener('visibilitychange', () => {
        if (document.visibilityState === 'visible') {
            startTimer();
        } else {
            stopTimer();
        }
    });

    // Start when the page loads and is visible
    if (document.visibilityState === 'visible') {
        startTimer();
    }

    // Optional: Clear timer if neededd d
    // localStorage.removeItem('visibleElapsed');

    const mobileSearch = document.querySelector(".mobile-search");
    const searchLink = document.querySelector(".search-link");
    const overlay2 = document.querySelector('.overlay2');
    const mobileSearchInput = document.getElementById('mobileSearch');

    searchLink.onclick = function() {
        mobileSearch.classList.toggle("hidden");
        overlay2.classList.toggle('hidden');
        mobileSearchInput.focus();

    };

    function toggleHidden(){
        mobileSearch.classList.toggle("hidden");
        overlay2.classList.toggle('hidden');
    }

    mobileSearchInput.addEventListener("focus", () => {
        searchCue2.classList.add("search-cue");
    });
    mobileSearchInput.addEventListener("focusout", () => {
        searchCue2.classList.remove("search-cue");
    });

    window.onscroll = function () { myFunction() };

    var navbar = document.getElementById("navbarr");
    var sticky = navbar.offsetTop;

    function myFunction() {
        if (window.scrollY >= sticky) {
            navbar.classList.add("sticky")
        } else {
            navbar.classList.remove("sticky");
        }
    }

    document.getElementById('login-form').addEventListener('submit', function (e) {
        e.preventDefault();

        var email = document.getElementById('email').value;
        var password = document.getElementById('password').value;
        var loginMessage = document.getElementById('login-message');
        var returnUrl = window.location.href;

        fetch('/User/LoginModal', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email: email, password: password, returnUrl: returnUrl})
        })
            .then(response => {
                if (!response.ok) {                   
                }
                return response.json();
            })
            .then(data => {
                if (data.success) {
                    // Login successful
                    console.log(data.message);
                    window.location.href = data.returnUrl || '/'; 
                } else {
                    // Login failed
                    console.log(data.message);
                    document.getElementById('login-message').textContent = data.message;
                }
            })
            .catch(error => console.error('Error:', error));
    });

    document.addEventListener('DOMContentLoaded', function () {
         const saved = localStorage.getItem('todayWatchTime');
          const todayElem2 = document.querySelector('.stats-2-boxes .stat-box:first-child h5:first-child .watch-time-value');
        let hrs = Math.floor(saved / 3600);
        let mins = Math.floor((saved % 3600) / 60);
        let secs = saved % 60;
        todayElem2.textContent = `${hrs > 0 ? hrs + 'h ' : ''}${mins}m ${secs}s`;

        const loginButton = document.getElementById('login-button');
        const loginButton2 = document.getElementById('login-button2');
        const loginModal = document.getElementById('login-modal');
        const closeBtn = document.getElementById('close-login-modal');
        const overlay = document.querySelector('.overlay');

        function toggleModal() {
            loginModal.classList.toggle('hidden');
            overlay.classList.toggle('hidden');
        }

        loginButton.addEventListener('click', toggleModal);
        loginButton2.addEventListener('click', toggleModal);
        closeBtn.addEventListener('click', toggleModal);
        overlay.addEventListener('click', toggleModal);
    });





    //sidebar
    const sidebar = document.getElementById('sidebar');
    const toggleButton = document.getElementById('toggleSidebar');
    const toggleButtonM = document.getElementById('toggleSidebarM');
    const main = document.querySelector('main');
    const mobileFooter = document.querySelector('.mobile-footer');
    const overlay = document.querySelector('.overlay');

    // Only add listeners if the buttons exist!
    if (toggleButton) {
        toggleButton.addEventListener('click', () => {
            console.log("desktop toggled");
            if (window.innerWidth >= 1000) {
                sidebar.classList.toggle('closed');
                main.classList.toggle('sidebar-closed');
            } else {
                sidebar.classList.toggle('open');
            }
        });
    }

    if (toggleButtonM) {
        toggleButtonM.addEventListener('click', () => {
            console.log("mobile toggled");
            if (window.innerWidth >= 1000) {
                sidebar.classList.toggle('closed');
                main.classList.toggle('sidebar-closed');
            } else {
                sidebar.classList.toggle('open');
 
            }
        });
    }

    // Check the screen size using media query
    //DETERMINE CSS CODE OR JS BASED ON DESKTOP VS MOBILE VIEW
    function checkScreenSize() {
        if (window.matchMedia("(max-width: 1000px)").matches) {                                    
            
            //  !!mobile devices here!!           
            console.log("Mobile mode detected");

            //TODO: grab hamburger on navbar, hide
            if (toggleButton) toggleButton.style.display = 'none';
            //TODO: grab hidden hamburger on mobile footer, show
            
            //detect clicks outside of sidebar and close sidebar if so
            // Close sidebar on outside click
            document.addEventListener("click", function (event) {
                const isClickInsideSidebar = sidebar.contains(event.target);
                const isClickOnToggle = toggleButton.contains(event.target);
                const isClickOnToggleM = toggleButtonM && toggleButtonM.contains(event.target);

                if (!isClickInsideSidebar && !isClickOnToggle && !isClickOnToggleM) {
                    sidebar.classList.remove("mobile-sidebar");
                    sidebar.classList.remove("open");

                }

            });

            toggleButton.onclick = function () {
                sidebar.classList.toggle("mobile-sidebar");
            }; 
            toggleButtonM.onclick = function () {
                sidebar.classList.toggle("mobile-sidebar");
            };

        } else {
            // Execute your JavaScript code for non-mobile devices
            console.log("Non-mobile mode detected");
            if (toggleButton) toggleButton.style.display = 'block';      // Hide top hamburger

 
        }
    }

    // Call the function when the page loads 
    window.onload = checkScreenSize;

    // Also call the function when the window is resized
    window.addEventListener("resize", checkScreenSize);
</script>

<!-- create account -->
<script>
    // Function to create a GUID
    function createGuid() {
        return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {
            const r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
            return v.toString(16);
        });
    }

    // Function to get a cookie by name
    function getCookie(name) {
        const value = `; ${document.cookie}`;
        const parts = value.split(`; ${name}=`);
        if (parts.length === 2) return parts.pop().split(';').shift();
    }

    // Function to set a cookie
    function setCookie(name, value, days) {
        let expires = "";
        if (days) {
            const date = new Date();
            date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
            expires = "; expires=" + date.toUTCString();
        }
        document.cookie = name + "=" + (value || "") + expires + "; path=/";
    }

    function sendGuidToServer(guid) {
        const xhr = new XMLHttpRequest();
        xhr.open("POST", "/User/CreateFreeAccount", true); // Adjust endpoint as necessary
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4) {
                if (xhr.status === 200) {
                    console.log("Account created successfully.");
                } else {
                    console.error("Error creating account. Status:", xhr.status);
                    console.error("Response:", xhr.responseText);
                }
            }
        };
        xhr.onerror = function () {
            console.error("Network error occurred");
        };
        xhr.send(JSON.stringify({ guid: guid }));
    }

    // Main logic: check cookie, create if not exists, send GUID to server
    (function () {
        const cookieName = "userGuid";
        let userGuid = getCookie(cookieName);

        if (!userGuid) {
            // Cookie not found, create a new GUID
            userGuid = createGuid();
            setCookie(cookieName, userGuid, 365); // Store for 1 year
            console.log("New GUID created and stored in cookie:", userGuid);

            // Send the GUID to the server to create a basic account
            sendGuidToServer(userGuid);
        } else {
            console.log("User GUID already exists:", userGuid);
        }
    })();




    //SAVE SESSION LENGTH
    let sessionStart = Date.now();

    // This handles tab close, reload, or navigation away
    window.addEventListener('beforeunload', () => {
       
        const payload = {
            SessionStart: new Date(sessionStart).toISOString(),
            SessionEnd: new Date(), // or Date.now()
            SessionDurationSeconds: Math.floor((Date.now() - sessionStart) / 1000),
            WatchTimeSeconds: Math.floor(totalWatchTime / 1000)
        };

        navigator.sendBeacon('/User/SaveSessionData', JSON.stringify(payload));
    });
</script>

